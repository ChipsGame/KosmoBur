<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no, minimum-scale=1.0">
    <meta name="yandex-games" content="true">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="color-scheme" content="dark">
    <!-- –ó–∞–ø—Ä–µ—Ç –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é -->
    <style>
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
            touch-action: manipulation;
        }
        
        /* –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –≤ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö */
        .modal {
            touch-action: pan-y !important;
        }
        
        .modal-content {
            touch-action: pan-y !important;
            -webkit-overflow-scrolling: touch !important;
            overflow-y: auto !important;
            overscroll-behavior: contain !important;
            pointer-events: auto !important;
        }
        
        /* –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –≤ —Å–µ—Ç–∫–µ —É–ª—É—á—à–µ–Ω–∏–π */
        .upgrades-grid {
            touch-action: pan-y !important;
            pointer-events: auto !important;
        }
        
        /* –†–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —É–ª—É—á—à–µ–Ω–∏–π */
        .upgrade-card {
            touch-action: pan-y !important;
            pointer-events: auto !important;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã */
        .upgrade-card button {
            touch-action: manipulation !important;
            pointer-events: auto !important;
        }
        
        /* ===== –ö–†–ê–°–ò–í–´–ô –§–û–ù - –ó–í–Å–ó–î–ù–û–ï –ù–ï–ë–û ===== */
        #game-container {
            background: linear-gradient(180deg, #0a0a1a 0%, #1a1a3a 30%, #0d1b2a 60%, #1b263b 100%);
            position: relative;
            overflow: hidden;
        }
        
        /* –ó–≤—ë–∑–¥—ã - —Å–ª–æ–π 1 (–º–µ–¥–ª–µ–Ω–Ω—ã–µ, –±–æ–ª—å—à–∏–µ) */
        .stars-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 200%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, rgba(255,255,255,0.8), transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 90px 40px, rgba(255,255,255,0.9), transparent),
                radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 230px 80px, rgba(255,255,255,0.8), transparent),
                radial-gradient(2px 2px at 300px 150px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 370px 50px, rgba(255,255,255,0.9), transparent),
                radial-gradient(2px 2px at 450px 180px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 520px 90px, rgba(255,255,255,0.8), transparent),
                radial-gradient(2px 2px at 600px 200px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 680px 60px, rgba(255,255,255,0.9), transparent),
                radial-gradient(2px 2px at 750px 140px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 820px 30px, rgba(255,255,255,0.8), transparent),
                radial-gradient(2px 2px at 900px 170px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 980px 100px, rgba(255,255,255,0.9), transparent);
            background-repeat: repeat;
            background-size: 1000px 250px;
            animation: starsMove 100s linear infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        /* –ó–≤—ë–∑–¥—ã - —Å–ª–æ–π 2 (–±—ã—Å—Ç—Ä–µ–µ, –ø–æ–º–µ–Ω—å—à–µ) */
        .stars-bg-2 {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 200%;
            background-image: 
                radial-gradient(1px 1px at 50px 100px, rgba(255,255,255,0.5), transparent),
                radial-gradient(1px 1px at 120px 50px, rgba(255,255,255,0.4), transparent),
                radial-gradient(1px 1px at 200px 150px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 280px 80px, rgba(255,255,255,0.5), transparent),
                radial-gradient(1px 1px at 350px 200px, rgba(255,255,255,0.4), transparent),
                radial-gradient(1px 1px at 420px 120px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 500px 40px, rgba(255,255,255,0.5), transparent),
                radial-gradient(1px 1px at 580px 180px, rgba(255,255,255,0.4), transparent),
                radial-gradient(1px 1px at 650px 90px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 720px 220px, rgba(255,255,255,0.5), transparent),
                radial-gradient(1px 1px at 800px 60px, rgba(255,255,255,0.4), transparent),
                radial-gradient(1px 1px at 880px 190px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 950px 110px, rgba(255,255,255,0.5), transparent);
            background-repeat: repeat;
            background-size: 1000px 250px;
            animation: starsMove 60s linear infinite;
            pointer-events: none;
            z-index: 0;
            opacity: 0.7;
        }
        
        /* –ú–µ—Ä—Ü–∞—é—â–∏–µ –∑–≤—ë–∑–¥—ã - —Å–ª–æ–π 3 */
        .stars-twinkle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 100px 200px, rgba(255,255,200,0.9), transparent),
                radial-gradient(1px 1px at 300px 100px, rgba(200,220,255,0.8), transparent),
                radial-gradient(2px 2px at 500px 300px, rgba(255,200,220,0.9), transparent),
                radial-gradient(1px 1px at 700px 150px, rgba(220,255,200,0.8), transparent),
                radial-gradient(2px 2px at 900px 250px, rgba(255,220,180,0.9), transparent);
            background-repeat: no-repeat;
            animation: twinkle 3s ease-in-out infinite alternate;
            pointer-events: none;
            z-index: 0;
        }
        
        /* –ü–ª–∞–Ω–µ—Ç–∞ –Ω–∞ –∑–∞–¥–Ω–µ–º –ø–ª–∞–Ω–µ */
        .planet-bg {
            position: absolute;
            bottom: -100px;
            right: -50px;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #667eea 0%, #764ba2 40%, #1a1a3a 100%);
            opacity: 0.3;
            box-shadow: 
                0 0 60px rgba(102, 126, 234, 0.4),
                inset -20px -20px 50px rgba(0,0,0,0.5);
            animation: planetFloat 20s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        /* –í—Ç–æ—Ä–∞—è –ø–ª–∞–Ω–µ—Ç–∞ */
        .planet-bg-2 {
            position: absolute;
            top: 10%;
            left: -80px;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle at 40% 40%, #f093fb 0%, #f5576c 50%, #1a1a3a 100%);
            opacity: 0.2;
            box-shadow: 
                0 0 40px rgba(240, 147, 251, 0.3),
                inset -15px -15px 40px rgba(0,0,0,0.5);
            animation: planetFloat 25s ease-in-out infinite reverse;
            pointer-events: none;
            z-index: 0;
        }
        
        /* –ú–µ—Ç–µ–æ—Ä */
        .meteor {
            position: absolute;
            width: 100px;
            height: 2px;
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.8) 50%, rgba(255,255,255,0) 100%);
            transform: rotate(-45deg);
            opacity: 0;
            animation: meteor 8s linear infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        .meteor:nth-child(6) {
            top: 20%;
            left: 80%;
            animation-delay: 0s;
        }
        
        .meteor:nth-child(7) {
            top: 40%;
            left: 60%;
            animation-delay: 3s;
        }
        
        .meteor:nth-child(8) {
            top: 60%;
            left: 90%;
            animation-delay: 6s;
        }
        
        @keyframes meteor {
            0% {
                opacity: 0;
                transform: translateX(0) translateY(0) rotate(-45deg);
            }
            10% {
                opacity: 1;
            }
            20% {
                opacity: 0;
                transform: translateX(-200px) translateY(200px) rotate(-45deg);
            }
            100% {
                opacity: 0;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes starsMove {
            from { transform: translateY(0); }
            to { transform: translateY(-250px); }
        }
        
        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }
        
        @keyframes planetFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        /* Canvas –ø–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–∞ - –ö–†–ò–¢–ò–ß–ù–û: absolute –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ä–∞–∑–¥–≤–æ–µ–Ω–∏—è */
        #gameCanvas {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            -webkit-transform: translateX(-50%);
            z-index: 1;
            display: block;
            /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –¥–ª—è —á–µ—Ç–∫–∏—Ö –ø–∏–∫—Å–µ–ª–µ–π */
            image-rendering: pixelated;
            image-rendering: crisp-edges;
            /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ */
            background-color: #0a0a1a;
        }
        
        /* UI –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
        }
        
                /* –§–∏–∫—Å –¥–ª—è iOS - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º pull-to-refresh –∏ —Ä–∞–∑–¥–≤–æ–µ–Ω–∏–µ */
        @supports (-webkit-touch-callout: none) {
            /* –£–ë–ò–†–ê–ï–ú translateZ(0) - –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–¥–≤–æ–µ–Ω–∏–µ –Ω–∞ iOS! */
            .modal-content {
                /* –ë–µ–∑ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ */
                backface-visibility: hidden;
                perspective: 1000px;
                transform-style: flat;
            }
            /* –§–∏–∫—Å –¥–ª—è —Ä–∞–∑–¥–≤–æ–µ–Ω–∏—è canvas –Ω–∞ iOS - –æ—Ç–∫–ª—é—á–∞–µ–º –í–°–ï –∞–Ω–∏–º–∞—Ü–∏–∏ —Ñ–æ–Ω–∞ */
            .stars-bg, .stars-bg-2, .stars-twinkle, .planet-bg, .planet-bg-2, .meteor {
                animation: none !important;
                display: none !important;
            }
            /* –£–ø—Ä–æ—â–∞–µ–º —Ñ–æ–Ω –¥–æ –æ–¥–Ω–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
            #game-container {
                background: linear-gradient(180deg, #0a0a1a 0%, #1a1a3a 100%) !important;
            }
            /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—ã –¥–ª—è iOS Safari */
            #gameCanvas {
                -webkit-backface-visibility: hidden;
                backface-visibility: hidden;
                -webkit-perspective: 1000;
                perspective: 1000px;
                -webkit-transform-style: flat;
                transform-style: flat;
            }
        }
        
        /* –ö–æ–≥–¥–∞ –º–æ–¥–∞–ª–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞ - —Ä–∞–∑—Ä–µ—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ body */
        body:has(.modal:not(.hidden)) {
            touch-action: pan-y;
        }
    </style>
    <title>–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –ë—É—Ä</title>
        <link rel="stylesheet" href="css/ui.css">
    <link rel="stylesheet" href="css/mobile-fixes.css">
    <link rel="stylesheet" href="css/touch-optimizations.css">
    <script src="https://yandex.ru/games/sdk/v2"></script>
</head>
<body>
    <div id="game-container">
        <canvas id="gameCanvas"></canvas>

        <!-- UI Overlay -->
        <div id="ui-layer">
            <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏ -->
            <div id="top-bar">
                <div class="resources-left">
                    <div class="resource">
                        <span class="icon">ü™ô</span>
                        <span id="coins">0</span>
                    </div>
                    <div class="resource">
                        <span class="icon">üíé</span>
                        <span id="ore">0</span>
                    </div>
                    <div id="depth-meter">0–º</div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é —Å–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞ -->
                <div id="top-menu">
                    <button id="btn-upgrades" class="menu-btn" title="–£–ª—É—á—à–µ–Ω–∏—è">üîß</button>
                    <button id="btn-achievements" class="menu-btn" title="–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è">üèÜ</button>
                    <button id="btn-settings" class="menu-btn" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</button>
                    <button id="btn-ad" class="menu-btn ad-btn" title="–†–µ–∫–ª–∞–º–∞ –∑–∞ –Ω–∞–≥—Ä–∞–¥—É">üì∫</button>
                </div>
            </div>

            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞ (–∫–ª–∏–∫–∏, –∞–≤—Ç–æ–∫–ª–∏–∫) - –±–µ–∑ —Ñ–æ–Ω–∞ -->
            <div id="status-panel">
                <span id="cps-display">0 –∫–ª–∏–∫/—Å</span>
                <span id="auto-display">ü§ñ 0/—Å</span>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –ø–∞—É–∑—ã -->
            <div id="pause-panel">
                <button id="btn-pause" class="pause-btn">‚è∏Ô∏è</button>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
        <div id="modal-upgrades" class="modal hidden">
            <div class="modal-content upgrades-modal-content">
                <button class="close-modal">‚úï</button>
                <h2>üîß –£–ª—É—á—à–µ–Ω–∏—è</h2>
                <div class="upgrades-grid">
                    <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
                </div>
            </div>
        </div>

        <div id="modal-achievements" class="modal hidden">
            <div class="modal-content achievements-modal">
                <button class="close-modal">‚úï</button>
                <h2>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <div id="achievements-list"></div>
            </div>
        </div>


    </div>
    
    <!-- –≠–∫—Ä–∞–Ω –ø–∞—É–∑—ã -->
    <div id="pause-screen">
        <div class="pause-title">‚è∏Ô∏è –ü–ê–£–ó–ê</div>
        <div class="pause-hint">–ù–∞–∂–º–∏—Ç–µ ‚ñ∂Ô∏è —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</div>
    </div>

    <!-- –§–∏–∫—Å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ viewport –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö -->
    <script>
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º viewport –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        (function() {
            function updateViewport() {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º documentElement.clientHeight –¥–ª—è iOS (–±–µ–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏)
                const vh = document.documentElement.clientHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                
                // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º –∞–¥—Ä–µ—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É –Ω–∞ iOS
                if (window.scrollY === 0) {
                    window.scrollTo(0, 1);
                }
            }
            updateViewport();
            window.addEventListener('resize', updateViewport);
            window.addEventListener('orientationchange', () => {
                setTimeout(updateViewport, 300);
            });
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ –¥–ª—è iOS
            window.addEventListener('scroll', updateViewport);
        })();
    </script>
    
    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="js/utils/MobileFixes.js"></script>
    <script src="js/utils/Utils.js"></script>
    <script src="js/systems/YandexSDK.js"></script>
    <script src="js/core/Renderer.js"></script>
    <script src="js/core/Input.js"></script>
    <script src="js/entities/Particle.js"></script>
    <script src="js/entities/Layer.js"></script>
    <script src="js/entities/Drill.js"></script>
    <script src="js/systems/Economy.js"></script>
    <script src="js/systems/Upgrades.js"></script>
    <script src="js/systems/DriftSystem.js"></script>
    <script src="js/systems/AutoDrill.js"></script>
    <script src="js/systems/Prestige.js"></script>
    <script src="js/systems/OfflineProgress.js"></script>
    <script src="js/systems/DailyRewards.js"></script>
    <script src="js/systems/Skins.js"></script>
    <script src="js/systems/BossSystem.js"></script>
    <script src="js/systems/SaveManager.js"></script>
    <script src="js/core/Game.js"></script>
</body>
</html>
